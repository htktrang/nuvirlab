"use strict";(self.webpackChunknuvirlab_dev=self.webpackChunknuvirlab_dev||[]).push([[720],{3126:(e,t,a)=>{a.d(t,{$:()=>i});var s=a(2195);function i(){const e=document.querySelector(".note");(0,s.o)(e,"br"),(0,s.o)(e,"span","",{id:"pivot"}),(0,s.o)(e,"br"),(0,s.o)(e,"span","",{id:"time"})}},5046:(e,t,a)=>{a.d(t,{TV:()=>l,bM:()=>o,bn:()=>m});const s=new(a(4583).z);let i,n,r=null;function o(e){e.params.showTime&&(i=document.querySelector("#time")),null!==r&&cancelAnimationFrame(r),s.start(),c(e)}function m(e){e.stop(),s.stop(),null!==r&&cancelAnimationFrame(r)}function l(e){e.stop(),s.stop(),null!==r&&cancelAnimationFrame(r),e.reset(),e.update()}function c(e){r=requestAnimationFrame((()=>{c(e)})),n=s.getElapsedTime(),e.params.showTime&&(i.innerText="Time: "+n.toFixed(e.params.timeToFixed)+" s"),e.params.time&&n>e.params.time?m(e):e.start()}},4537:(e,t,a)=>{a.d(t,{l:()=>r,z:()=>n});var s=a(2195),i=a(5046);function n(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[["Rotate","Start"],["Pause","Pause"],["Stop","Stop"]]).forEach((e=>{!function(e,t){const a=document.querySelector(".control-container");(0,s.o)(a,"button",e,{class:"control-button",id:t})}(e[0],e[1])}))}function r(e){document.querySelector("#Start").addEventListener("click",(()=>{(0,i.bM)(e)}),!1),document.querySelector("#Pause").addEventListener("click",(()=>{(0,i.bn)(e)}),!1),document.querySelector("#Stop").addEventListener("click",(()=>{(0,i.TV)(e)}),!1)}},37:(e,t,a)=>{function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}a.d(t,{Z:()=>s})},852:(e,t,a)=>{a.d(t,{d:()=>n});var s=a(9437),i=a(733);function n(e,t,a){const n=new s.eaF(e,t);return a.setXLength&&(n.scale.x=(0,i.I)(a.setXLength)),a.setYLength&&(n.scale.y=(0,i.I)(a.setYLength)),a.setZLength&&(n.scale.z=(0,i.I)(a.setZLength)),n}},1759:(e,t,a)=>{a.d(t,{L:()=>o,Mk:()=>r,Y4:()=>n});var s=a(9437),i=a(733);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=o((0,i.I)(e.setRmin),(0,i.I)(e.setRmax),(0,i.I)(e.setHeight),t);return a&&(s.rotation.x=Math.PI/2),s}function r(e,t){if(t.setTranslation){const a=(0,i.X)(t.setTranslation);e.position.set(a.x,a.y,a.z)}}function o(e,t,a,i){const n=new s.B6O([new s.Pq0(0,-a/2,0),new s.Pq0(0,a/2,0)]);let r=new s.ypk;r.absarc(0,0,t,0,2*Math.PI),r.holes.push((new s.wAk).absarc(0,0,e,0,2*Math.PI,!1));let o=new s.QCA(r,{steps:100,bevelEnabled:!1,extrudePath:n});return new s.eaF(o,i)}},2142:(e,t,a)=>{a.d(t,{J9:()=>r,Ih:()=>n});var s=a(1824);var i=a(6243);function n(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=function(e){const t=(0,s.Y)(e),a=["x","y","z"];for(let e=0;e<t.length;e++)if("1"==t[e])return a[e]}(t.setRotationAxis);let r=function(e){const t=(0,s.Y)(e);return(0,i.C6)(t[0],"degree").to("radian")}(t.setRotationAngle);a&&(r=-r),e.rotation[n]=r}function r(e,t,a,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];i&&e.parent.localToWorld(e.position),e.position.sub(t),e.position.applyAxisAngle(a,s),e.position.add(t),i&&e.parent.worldToLocal(e.position),e.rotateOnAxis(a,s)}},3260:(e,t,a)=>{a.d(t,{b:()=>i,w:()=>n});var s=a(733);function i(e,t){const a=(0,s.X)(t.setTranslation);e.position.set(a.x,a.z,a.y)}function n(e,t){const a=(0,s.X)(t.setTranslation);e.position.set(a.x,a.y,a.z)}},8405:(e,t,a)=>{var s=a(733),i=a(194),n=a(1116),r=a(7485),o=a(2264),m=a(9437),l=a(7346),c=a(1246);function h(e){return new m.Fpm(e)}function p(e){const t=e.params,a=function(e){return{solid:new m._4j({color:e.params.setColor,transparent:!0,opacity:1,depthWrite:!0,wireframe:!1})}}(e);let i=.001,n=0,r=0,o=0,l=t.deg,c=1,p=0;if(Object.hasOwn(t,"ang_focuspoint")&&Object.hasOwn(t,"pos_centre")&&Object.hasOwn(t,"pos_radius")&&Object.hasOwn(t,"ang_focuspoint")){c=(0,s.X)(t.ang_focuspoint),n=c.x,r=c.y,o=c.z;let e=(0,s.X)(t.pos_centre);p=(0,s.I)(t.pos_radius),i=e.z-c.z,l=m.cj9.radToDeg(Math.atan(p/i))}Object.hasOwn(t,"pos_sigma_x")&&(i=(0,s.I)(t.pos_sigma_x));const g=new m.Gu$(i),d=new m.eaF(g,a.solid);d.name="Source",d.position.set(n,r,o);const u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"green",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;const s=new m.nCl;return s.color.setColorName(e),s.intensity=5,s.penumbra=.1,s.decay=1,s.castShadow=!0,s.shadowCameraVisible=!0,s.shadowDarkness=.95,s.position.set(t.position.x,t.position.y,t.position.z),s.angle=m.cj9.degToRad(a),s}("yellow",d,l);u.name="SpotLight",u.target.position.set(e.target.position.x,e.target.position.y,e.target.position.z),t.intensity&&(u.intensity=t.intensity);const b=h(u.clone());return b.name="SpotLightHelper",{source:d,spotlight:u,spotlightHelper:b}}var g=a(1007),d=a(6019);function u(e){const t=e.children[1];e.remove(e.children[2]);const a=h(t.clone());e.add(a)}var b=a(7187);var _=a(3963);var y=a(9774),f=a(8186);function w(e,t,a,s){const i=(0,d.P)(a,"Source");let n=t.addFolder(s.name);n.close();const r=structuredClone(s);(0,y.h)(e,n,a,s),s.radiusname&&n.add(s,"radius",0,e.size).name(s.radiusname).onChange((t=>{i.scale.setScalar(t/i.geometry.parameters.radius),e.update()})),function(e,t,a,s){const i=(0,d.P)(a,"Source"),n=(0,d.P)(a,"SpotLight");s.posXname&&t.add(s,"posX",-e.size/2,e.size/2).name(s.posXname).onChange((t=>{i.position.x=t,n.position.x=t,u(a),e.update()})),s.posYname&&t.add(s,"posY",-e.size/2,e.size/2).name(s.posYname).onChange((t=>{i.position.y=t,n.position.y=t,u(a),e.update()})),s.posZname&&t.add(s,"posZ",-e.size/2,e.size/2).name(s.posZname).onChange((t=>{i.position.z=t,n.position.z=t,u(a),e.update()}))}(e,n,a,s),(0,_.N)(e,n,i,s),function(e,t,a,s){const i=(0,d.P)(a,"SpotLight");s.lightcolorname&&t.addColor(s,"lightcolor").name(s.lightcolorname).onChange((t=>{i.color.set(t),e.update()})),s.lightanglename&&t.add(s,"lightangle",0,180).name(s.lightanglename).onChange((t=>{i.angle=m.cj9.degToRad(t),u(a),e.update()}))}(e,n,a,s),(0,f.R)(n,i,s),s.resetname&&(s.reset=()=>{},n.add(s,"reset").name("Reset "+s.spherename).onChange((()=>{!function(e,t,a){const s=(0,d.P)(t,"Source"),i=e.__controllers;a.radiusname&&((0,b.ng)(i,"radius"),s.scale.setScalar(a.radius/s.geometry.parameters.radius));(function(e,t,a){const s=(0,d.P)(e,"Source"),i=(0,d.P)(e,"SpotLight");a.posXname&&((0,b.ng)(t,"posX"),s.position.x=a.posX,i.position.x=a.posX,u(e)),a.posYname&&((0,b.ng)(t,"posY"),s.position.y=a.posY,i.position.y=a.posY,u(e)),a.posZname&&((0,b.ng)(t,"posZ"),s.position.z=a.posZ,i.position.z=a.posZ,u(e))})(t,i,a),(0,_.e)(s,i,a),function(e,t,a){const s=(0,d.P)(e,"SpotLight");a.lightcolorname&&((0,b.ng)(t,"lightcolor"),s.color.set(a.lightcolor)),a.lightanglename&&((0,b.ng)(t,"lightangle"),s.angle=m.cj9.degToRad(a.lightangle),u(e))}(t,i,a),(0,y.v)(t,i,a),(0,f.P)(s,i,a)}(n,a,r),e.update()})))}var x=a(1411);const R={name:"Cone beam light",setMaterial:"solid",setVisible:"1",setColor:"red",description:"Cone beam light",setLabel:!0,setGui:!0};class T extends m.YJl{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.target=t,this.params={...R,...a},this.name=this.params.name,(0,x.X)("inforComponents",this.params.description),this.meshes=p(this),this.add(this.meshes.source,this.meshes.spotlight,this.meshes.spotlightHelper),this.params.setLabel&&function(e){const t=(0,d.P)(e,"Source"),a=(0,g.f)(t.name,t.geometry.parameters.radius,t.geometry.parameters.radius);t.add(a)}(this),this.params.setGui&&function(e,t){const a=t.gui,s=(0,d.P)(e,"Source"),i=(0,d.P)(e,"SpotLight");w(t,a,e,{name:"Cone beam light",spherename:s.name?s.name:"Sphere",radius:s.geometry.parameters.radius,radiusname:"Radius (m)",posX:s.position.x,posXname:"Source X (m)",posY:s.position.y,posYname:"Source Y (m)",posZ:s.position.z,posZname:"Source Z (m)",color:s.material.color.getHex(),colorname:"Source color",lightname:"Cone beam light",lightcolor:i.color.getHex(),lightcolorname:"Light color",lightangle:m.cj9.radToDeg(i.angle),lightanglename:"Light angle",visible:e.visible,visiblename:"Visible",label:"Source",labelname:"Label",labelColor:16777215,labelColorname:"Label color",resetname:"Reset"})}(this,e)}}var L=a(8523);var z=a(37);const C={name:"Box",insert:"box",setMaterial:"Water",setXLength:"0.4 m",setYLength:"0.4 m",setZLength:"0.4 m",setVisible:"1",setColor:"blue",setLabel:!0,setGui:!0};class v extends m.eaF{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.params={...C,...t},this.name=this.params.name;let a=(0,z.Z)(this.params.setMaterial);this.label=this.params.label?this.params.label:this.params.name,this.params.description=`${a} box (${this.params.setXLength} x ${this.params.setYLength} x ${this.params.setZLength})`,(0,x.X)("inforComponents",this.params.description),function(e){const t=e.params;e.material=new m._4j({color:t.setColor?t.setColor:"aqua",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),e.geometry=new m.iNn(1,1,1),t.setXLength&&(e.scale.x=(0,s.I)(t.setXLength)),t.setYLength&&(e.scale.y=(0,s.I)(t.setYLength)),t.setZLength&&(e.scale.z=(0,s.I)(t.setZLength))}(this),this.params.setLabel&&function(e){const t=(0,g.f)(e.label,e.geometry.parameters.width/2,e.geometry.parameters.height/2);t.name="label"+e.name,e.add(t)}(this),this.params.setGui&&function(e,t){const a=t.gui,i=e.params;let n=(0,s.I)(i.setXLength),r=(0,s.I)(i.setYLength),o=(0,s.I)(i.setZLength),m={x:0,y:0,z:0};i.setTranslation&&(m=(0,s.X)(i.setTranslation));const l={name:e.label,visible:e.visible,visiblename:"Visible",sizeX:n,sizeXname:"Size X (m)",sizeY:r,sizeYname:"Size Y (m)",sizeZ:o,sizeZname:"Size Z (m)",posX:m.x,posXname:"Position X (m)",posY:m.y,posYname:"Position Y (m)",posZ:m.z,posZname:"Position Z (m)",color:e.material.color.getHex(),colorname:"Color",opacity:e.material.opacity,opacityname:"Opacity",wireframe:e.material.wireframe,wireframename:"Wireframe",label:e.label,labelname:"Label",labelColor:16777215,labelColorname:"Label color",resetname:"Reset Box"};(0,L.S)(t,a,e,l)}(this,e)}}var M=a(852),H=a(1387),S=a(1759);var Y=a(5897);var X=a(3260);function P(e,t,a,s){const i=function(e,t,a){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=new m.eaF(e,t);(0,H.ig)(i,{setRtop:a.setRmax2,setRbottom:a.setRmax1,setHeight:a.setHeight});const n=new m.eaF(e,t);(0,H.ig)(n,{setRtop:a.setRmin2,setRbottom:a.setRmin1,setHeight:a.setHeight});const r=Y.wv.fromMesh(i,0),o=Y.wv.fromMesh(n,1);let l;const c=n.geometry.parameters;l=0==c.radiusTop&&0==c.radiusBottom?r:r.subtract(o);const h=Y.wv.toMesh(l,new m.kn4);return h.material=i.material,s&&(h.rotation.x=Math.PI/2),h}(t,a,s,!1);s.setTranslation&&(0,X.b)(i,s),e.add(i)}function V(e,t,a){let s=(0,H.T8)(t,a);t.setTranslation&&(0,X.b)(s,t),e.add(s)}var Z=a(2142);function k(e){const t=e.params;e.name=t.name;const a=function(e){const t=new m._4j({color:"red",transparent:!0,opacity:.5,depthWrite:!0});return{air:new m._4j({color:e.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!0}),target:new m._4j({color:e.target.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),copper:new m._4j({color:e.target_support_bottom.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),collimator:new m._4j({color:e.primary_collimator.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),filter:new m._4j({color:e.flattening_filter_cone1.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),mylar:new m._4j({color:"white",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),carbon:new m._4j({color:"black",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),alum:new m._4j({color:e.back_scatter_plate.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),solid:t}}(t),s={box:new m.iNn(1,1,1),cylinder:new m.Ho_(1,1,1,32)},i=(0,M.d)(s.box,a.air,t),n=function(e,t,a){const s=new m.eaF(e.cylinder,t.air);s.name=a.target_support.name,(0,H.d4)(s,{setRmax:a.target_support.setRmax,setHeight:a.target_support.setHeight});const i=new m.eaF(e.cylinder,t.target);i.name=a.target.name,(0,H.d4)(i,{setRmax:a.target.setRmax,setHeight:a.target.setHeight,setTranslation:a.target.setTranslation});const n=(0,S.Y4)(a.target_support_top,t.copper);n.name=a.target_support_top.name,(0,S.Mk)(n,{setTranslation:a.target_support_top.setTranslation});const r=new m.eaF(e.cylinder,t.copper);r.name=a.target_support_bottom.name,(0,H.d4)(r,{setRmax:a.target_support_bottom.setRmax,setHeight:a.target_support_bottom.setHeight,setTranslation:a.target_support_bottom.setTranslation});const o=new m.YJl;return o.add(s,i,n,r),o}(s,a,t);(0,X.w)(n,t.target_support);const r=function(e,t,a){const s=new m.eaF(e.cylinder,t.collimator);(0,H.d4)(s,{setRmax:a.primary_collimator.setRmax1,setHeight:a.primary_collimator.setHeight});const i=new m.eaF(e.cylinder,t.air);(0,H.ig)(i,{setRtop:a.primary_collimator.setRmin2,setRbottom:a.primary_collimator.setRmin1,setHeight:a.primary_collimator.setHeight});const n=Y.wv.fromMesh(s,0),r=Y.wv.fromMesh(i,1),o=n.subtract(r),l=Y.wv.toMesh(o,new m.kn4);return l.material=s.material,l.rotation.x=Math.PI/2,l.name=a.primary_collimator.name,l}(s,a,t);(0,X.w)(r,t.primary_collimator);const o=function(e,t,a){const s=new m.YJl;for(let i=1;i<=6;i++)P(s,e.cylinder,t.filter,a[`flattening_filter_cone${i}`]);return s.rotation.x=Math.PI/2,s.name=a.flattening_filter.name,s}(s,a,t);(0,X.w)(o,t.flattening_filter);const l=function(e,t){const a=new m.YJl;for(let s=1;s<=6;s++)V(a,t[`ionizing_chamber_mylar_1ayer${s}`],e.mylar),V(a,t[`ionizing_chamber_carbon_1ayer${s}`],e.carbon);return a.rotation.x=Math.PI/2,a.name=t.ionizing_chamber.name,a}(a,t);(0,X.w)(l,t.ionizing_chamber);const c=(0,M.d)(s.box,a.alum,t.back_scatter_plate);c.name=t.back_scatter_plate.name,(0,X.w)(c,t.back_scatter_plate);const h=function(e,t,a){const s=new m.YJl,i=(0,M.d)(e,t.mylar,a.mirror_mylar);i.material.color=new m.Q1f(a.mirror_mylar.setColor),(0,X.w)(i,{setTranslation:a.mirror_mylar.setTranslation});const n=(0,M.d)(e,t.alum,a.mirror_aluminium);return n.material.color=new m.Q1f(a.mirror_aluminium.setColor),(0,X.w)(n,{setTranslation:a.mirror_aluminium.setTranslation}),s.add(i,n),s.name=a.mirror.name,s}(s.box,a,t);return(0,X.w)(h,t.mirror),(0,Z.Ih)(h,t.mirror,t.isG4),{head:i,target:n,collimator:r,filter:o,chamber:l,plate:c,mirror:h}}var I=a(2328);const A={name:"Linac head",insert:"box",setMaterial:"Air",setXLength:"0.5 m",setYLength:"0.5 m",setZLength:"0.8 m",setTranslation:"0 0 0 m",setVisible:"1",setColor:"yellow",setLabel:!0,setGui:!0,isG4:!0,target_support:{name:"target_support",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"15 mm",setHeight:"11 mm",setTranslation:"0 0 -5 mm",setVisible:"1"},target:{name:"target",insert:"cylinder",setMaterial:"target",setRmin:"0 mm",setRmax:"2.70 mm",setHeight:"1.00 mm",setTranslation:"0 0 5 mm",setColor:"red",setVisible:"1"},target_support_top:{name:"target_support_top",insert:"cylinder",setMaterial:"Copper",setRmin:"2.70 mm",setRmax:"15 mm",setHeight:"1.00 mm",setTranslation:"0 0 5 mm",setColor:"green",setVisible:"1"},target_support_bottom:{name:"target_support_bottom",insert:"cylinder",setMaterial:"Copper",setRmin:"0 mm",setRmax:"15 mm",setHeight:"10 mm",setTranslation:"0 0 -0.5 mm",setColor:"green",setVisible:"1"},primary_collimator:{name:"primary_collimator",insert:"cone",setMaterial:"collimator",setRmin2:"6.45 mm",setRmax2:"82 mm",setRmin1:"31.45 mm",setRmax1:"82 mm",setHeight:"101 mm",setTranslation:"0 0 -65.5 mm",setColor:"blue",setVisible:"1"},flattening_filter:{name:"flattening_filter",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"40 mm",setHeight:"24.1 mm",setTranslation:"0.0 0.0 -146.05 mm",setVisible:"0"},flattening_filter_cone1:{name:"flattening_filter_cone1",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"0.001 mm",setRmin1:"0 mm",setRmax1:"5.45 mm",setHeight:"3.40 mm",setTranslation:"0.0 0.0 +10.35 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone2:{name:"flattening_filter_cone2",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"5.45 mm",setRmin1:"0 mm",setRmax1:"9.00 mm",setHeight:"2.70 mm",setTranslation:"0.0 0.0 +7.3 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone3:{name:"flattening_filter_cone3",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"9.00 mm",setRmin1:"0 mm",setRmax1:"14.50 mm",setHeight:"4.90 mm",setTranslation:"0.0 0.0 +3.5 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone4:{name:"flattening_filter_cone4",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"14.50 mm",setRmin1:"0 mm",setRmax1:"22.50 mm",setHeight:"5.50 mm",setTranslation:"0.0 0.0 -1.7 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone5:{name:"flattening_filter_cone5",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"22.50 mm",setRmin1:"0 mm",setRmax1:"32.50 mm",setHeight:"5.60 mm",setTranslation:"0.0 0.0 -7.25 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone6:{name:"flattening_filter_cone6",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"38.50 mm",setRmin1:"0 mm",setRmax1:"38.50 mm",setHeight:"2.0 mm",setTranslation:"0.0 0.0 -11.05 mm",setColor:"yellow",setVisible:"1"},ionizing_chamber:{name:"ionizing_chamber",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"45 mm",setHeight:"9.28 mm",setTranslation:"0.0 0.0 -169 mm",setVisible:"0"},ionizing_chamber_mylar_1ayer1:{name:"ionizing_chamber_mylar_1ayer1",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 -2.634 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer1:{name:"ionizing_chamber_carbon_1ayer1",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 -2.627925 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer2:{name:"ionizing_chamber_mylar_1ayer2",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 -0.434 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer2:{name:"ionizing_chamber_carbon_1ayer2",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 -0.427925 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer3:{name:"ionizing_chamber_mylar_1ayer3",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 0.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer3:{name:"ionizing_chamber_carbon_1ayer3",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 0.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer4:{name:"ionizing_chamber_mylar_1ayer4",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 1.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer4:{name:"ionizing_chamber_carbon_1ayer4",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 1.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer5:{name:"ionizing_chamber_mylar_1ayer5",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 2.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer5:{name:"ionizing_chamber_carbon_1ayer5",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 2.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer6:{name:"ionizing_chamber_mylar_1ayer6",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 3.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer6:{name:"ionizing_chamber_carbon_1ayer6",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 3.572075 mm",setVisible:"1"},back_scatter_plate:{name:"back_scatter_plate",insert:"box",setMaterial:"Aluminium",setXLength:"116 mm",setYLength:"84 mm",setZLength:"3 mm",setTranslation:"0 0 -183 mm",setVisible:"1",setColor:"red"},mirror:{name:"mirror",insert:"box",setMaterial:"Air",setXLength:"137 mm",setYLength:"137 mm",setZLength:"1.5 mm",setTranslation:"0.0 0.0 -225 mm",setRotationAxis:"1 0 0",setRotationAngle:"37.5 deg",setVisible:"1"},mirror_mylar:{name:"mirror_mylar",insert:"box",setMaterial:"Mylar",setXLength:"110 mm",setYLength:"110 mm",setZLength:"0.0012 mm",setTranslation:"0 0 0.15 mm",setVisible:"1",setColor:"blue"},mirror_aluminium:{name:"mirror_aluminium",insert:"box",setMaterial:"Aluminium",setXLength:"110 mm",setYLength:"110 mm",setZLength:"0.0003 mm",setTranslation:"0 0 -0.6 mm",setVisible:"1",setColor:"white"}};class j extends m.YJl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.params={...A,...t},this.labels=[],this.params.description="Linac head includes target, primary collimator, flattening filter, \n    ionizing chamber, back scatter plate, mirror",(0,x.X)("inforComponents",this.params.description),this.meshes=k(this),this.add(this.meshes.head,this.meshes.target,this.meshes.collimator,this.meshes.filter,this.meshes.chamber,this.meshes.plate,this.meshes.mirror),this.params.setLabel&&function(e){e.params;const t=e.meshes.head,a=(0,g.f)(e.name,0,t.geometry.parameters.width/3,-t.geometry.parameters.height/3);a.name="label"+e.name,e.add(a),e.labels.push(a.name)}(this),this.params.setGui&&function(e,t){const a=t.gui,s={name:"Linac head",visible:e.visible,visiblename:"Visible",opacity:.5,opacityname:"Opacity",label:"Linac head",labelname:"Label",labelColor:16777215,labelColorname:"Label color",labelVisible:(0,d.P)(e,e.labels[0]).visible,labelVisiblename:"Label visible",resetname:"Reset Linac head"};(0,I.C)(t,a,e,s)}(this,e)}}var F=a(7399);var O=a(6584),W=a(7986),D=a(4537),q=a(3126);const E={description:"Simulation: Medical linear accelerator (LINAC)",infors:{authors:["Trang Hoang, Huynh Anh Dung"],data:"https://drive.google.com/file/d/1SM_gq5qj8Bje9DgJMZrDsm8MJFb_QDTs",refs:{"SARRUT David, Gate exercices, 3_linac":"https://gitlab.in2p3.fr/davidsarrut/gate-exercices/-/tree/master/3_linac?ref_type=heads"}},color:6316128,setLabel:!0,setGui:!0,showInfor:!0,world:{setMaterial:"Air",setXLength:"1. m",setYLength:"1. m",setZLength:"2.5. m"},waterbox:{name:"waterbox",setXLength:"300 mm",setYLength:"300 mm",setZLength:"300 mm",setTranslation:"0 0 -1000 mm",setColor:"blue"},source:{pos_sigma_x:"1.274 mm",pos_sigma_y:"1.274 mm",deg:.1,intensity:50},animation:!0,showTime:!0,delta:1/60,cycleTime:10,timeToFixed:1,get time(){return 2*this.cycleTime},radsPerCycle:Math.PI,get angularVelocity(){return this.radsPerCycle/this.cycleTime},get tickTheta(){return this.delta*this.angularVelocity}};class G extends m.YJl{constructor(e,t,a){super(),this.params={...E,...a},this.description="Simulation: Medical linear accelerator (LINAC)",this.size=e,this.gui=t,this.axis=!0,this.meshes=function(e){const t=e.size,a=new v(e,e.params.waterbox);a.name=e.params.waterbox.name;const i=(0,s.X)(e.params.waterbox.setTranslation);return a.position.set(i.x,i.y,i.z),{phantom:a,linac:new j(e),conebeamLight:new T(e,a,e.params.source),axes:(0,l.W)(t/2,"m",t/2e3,e.axis),beam:(0,c.c)()}}(this),this.add(this.meshes.axes,this.meshes.phantom,this.meshes.linac,this.meshes.conebeamLight,this.meshes.beam),this.runs=[],this.reset(),this.params.setGui&&function(e){const t=e.gui,a={name:"World",rotX:m.cj9.radToDeg(e.rotation.x),rotXname:"Rotation X",rotY:m.cj9.radToDeg(e.rotation.y),rotYname:"Rotation Y",rotZ:m.cj9.radToDeg(e.rotation.z),rotZname:"Rotation Z",bgColor:e.params.color,bgColorname:"Background",resetname:"Reset World"};(0,L.S)(e,t,e,a);const s=e.meshes.axes,i={name:"Axes",visible:s.visible,visiblename:"Visible"};(0,F.m)(e,t,s,i)}(this),this.params.animation&&(this.pivotPoint=new m.Pq0(0,0,0),console.log(this.pivotPoint),this.rotationAxis=new m.Pq0(0,0,1),(0,D.z)(),(0,D.l)(this),this.params.showTime&&(0,q.$)())}setBackgroundColor(){}update(){}zoom(e){}reset(){this.zoomscale=4,this.rotation.set(-Math.PI/2,0,Math.PI/2),this.position.set(0,0,.5*this.size)}start(){}stop(){}tick(e){(0,Z.J9)(this,this.pivotPoint,this.rotationAxis,this.params.tickTheta,!1)}async init(){this.setBackgroundColor(this.params.color),this.zoom(this.zoomscale),(0,O.s)(this,this.params.showInfor),await(0,W.$)(this)}}var B=a(6297),J=a(4049),$=a(4393),N=a(6266),Q=a(4376);let U,K,ee,te,ae,se,ie,ne,re=0;class oe{constructor(e){this.worldParams={setXLength:E.world.setXLength,setYLength:E.world.setYLength,setZLength:E.world.setZLength},Object.keys(this.worldParams).forEach((e=>{if(e.includes("Length")){let t=(0,s.I)(this.worldParams[e]);re<t&&(re=t)}})),U=(0,i.W)(0,0,re),te=(0,r.B)(),K=(0,J.K)(),ee=(0,$.m)(),ie=(0,o._)(),ae=new Q.F(U,te,K,ee),e.append(K.domElement,ee.domElement),se=(0,B.B)(U,ee.domElement),ne=new G(re,ie,this.worldParams),(0,n.mD)(U,10,10,10,"white",3),ae.updatables.push(se,ne),te.add(U,ne),ne.setBackgroundColor=e=>{te.background=new m.Q1f(e),this.render()},ne.zoom=e=>{U.position.z*=e,this.render()},ne.update=()=>{this.render()},ne.start=()=>{ae.start()},ne.stop=()=>{ae.stop()};new N.L(e,U,K,ee).onResize=()=>{this.render()},se.addEventListener("change",(()=>{this.render()}))}render(){K.render(te,U),ee.render(te,U)}start(){ae.start()}stop(){ae.stop()}async init(){await ne.init()}}a(6795),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",ready):async function(){const e=document.querySelector("#scene-container");e.style.display="block";const t=new oe(e);await t.init(),t.render()}().catch((e=>{console.log(e)}))},6795:(e,t,a)=>{a.r(t)},4583:(e,t,a)=>{a.d(t,{z:()=>s});class s{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=i(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=i();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function i(){return("undefined"==typeof performance?Date:performance).now()}}},e=>{e.O(0,[708,566,441],(()=>{return t=8405,e(e.s=t);var t}));e.O()}]);