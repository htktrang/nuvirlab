"use strict";(self.webpackChunknuvirlab_dev=self.webpackChunknuvirlab_dev||[]).push([[282],{8043:(e,t,a)=>{function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}a.d(t,{f:()=>s})},9167:(e,t,a)=>{a.d(t,{s:()=>n});var s=a(9477),i=a(1098);function n(e,t,a){const n=new s.Kj0(e,t);return a.setXLength&&(n.scale.x=(0,i.v)(a.setXLength)),a.setYLength&&(n.scale.y=(0,i.v)(a.setYLength)),a.setZLength&&(n.scale.z=(0,i.v)(a.setZLength)),n}},6482:(e,t,a)=>{a.d(t,{JA:()=>r,JS:()=>o,z_:()=>n});var s=a(9477),i=a(1098);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=o((0,i.v)(e.setRmin),(0,i.v)(e.setRmax),(0,i.v)(e.setHeight),t);return a&&(s.rotation.x=Math.PI/2),s}function r(e,t){if(t.setTranslation){const a=(0,i.A)(t.setTranslation);e.position.set(a.x,a.y,a.z)}}function o(e,t,a,i){const n=new s.YT8([new s.Pa4(0,-a/2,0),new s.Pa4(0,a/2,0)]);let r=new s.bnF;r.absarc(0,0,t,0,2*Math.PI),r.holes.push((new s.y$t).absarc(0,0,e,0,2*Math.PI,!1));let o=new s.O7d(r,{steps:100,bevelEnabled:!1,extrudePath:n});return new s.Kj0(o,i)}},3855:(e,t,a)=>{a.d(t,{L:()=>i,x:()=>n});var s=a(1098);function i(e,t){const a=(0,s.A)(t.setTranslation);e.position.set(a.x,a.z,a.y)}function n(e,t){const a=(0,s.A)(t.setTranslation);e.position.set(a.x,a.y,a.z)}},293:(e,t,a)=>{var s=a(1098),i=a(6898),n=a(2537),r=a(234),o=a(7897),m=a(9477),l=a(5713),c=a(2940);function h(e){return new m.FvO(e)}function g(e){const t=e.params,a=function(e){return{solid:new m.Wid({color:e.params.setColor,transparent:!0,opacity:1,depthWrite:!0,wireframe:!1})}}(e);let i=.001,n=0,r=0,o=0,l=t.deg,c=1,g=0;if(Object.hasOwn(t,"ang_focuspoint")&&Object.hasOwn(t,"pos_centre")&&Object.hasOwn(t,"pos_radius")&&Object.hasOwn(t,"ang_focuspoint")){c=(0,s.A)(t.ang_focuspoint),n=c.x,r=c.y,o=c.z;let e=(0,s.A)(t.pos_centre);g=(0,s.v)(t.pos_radius),i=e.z-c.z,l=m.M8C.radToDeg(Math.atan(g/i))}Object.hasOwn(t,"pos_sigma_x")&&(i=(0,s.v)(t.pos_sigma_x));const p=new m.xo$(i),d=new m.Kj0(p,a.solid);d.name="Source",d.position.set(n,r,o);const b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"green",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;const s=new m.PMe;return s.color.setColorName(e),s.intensity=5,s.penumbra=.1,s.decay=1,s.castShadow=!0,s.shadowCameraVisible=!0,s.shadowDarkness=.95,s.position.set(t.position.x,t.position.y,t.position.z),s.angle=m.M8C.degToRad(a),s}("yellow",d,l);b.name="SpotLight",b.target.position.set(e.target.position.x,e.target.position.y,e.target.position.z),t.intensity&&(b.intensity=t.intensity);const u=h(b.clone());return u.name="SpotLightHelper",{source:d,spotlight:b,spotlightHelper:u}}var p=a(5140),d=a(9559);function b(e){const t=e.children[1];e.remove(e.children[2]);const a=h(t.clone());e.add(a)}var u=a(3848);var _=a(7833);var y=a(4340),f=a(8621);function x(e,t,a,s){const i=(0,d.J)(a,"Source");let n=t.addFolder(s.name);n.close();const r=structuredClone(s);(0,y.Q)(e,n,a,s),s.radiusname&&n.add(s,"radius",0,e.size).name(s.radiusname).onChange((t=>{i.scale.setScalar(t/i.geometry.parameters.radius),e.update()})),function(e,t,a,s){const i=(0,d.J)(a,"Source"),n=(0,d.J)(a,"SpotLight");s.posXname&&t.add(s,"posX",-e.size/2,e.size/2).name(s.posXname).onChange((t=>{i.position.x=t,n.position.x=t,b(a),e.update()})),s.posYname&&t.add(s,"posY",-e.size/2,e.size/2).name(s.posYname).onChange((t=>{i.position.y=t,n.position.y=t,b(a),e.update()})),s.posZname&&t.add(s,"posZ",-e.size/2,e.size/2).name(s.posZname).onChange((t=>{i.position.z=t,n.position.z=t,b(a),e.update()}))}(e,n,a,s),(0,_.s)(e,n,i,s),function(e,t,a,s){const i=(0,d.J)(a,"SpotLight");s.lightcolorname&&t.addColor(s,"lightcolor").name(s.lightcolorname).onChange((t=>{i.color.set(t),e.update()})),s.lightanglename&&t.add(s,"lightangle",0,180).name(s.lightanglename).onChange((t=>{i.angle=m.M8C.degToRad(t),b(a),e.update()}))}(e,n,a,s),(0,f.k)(n,i,s),s.resetname&&(s.reset=()=>{},n.add(s,"reset").name("Reset "+s.spherename).onChange((()=>{!function(e,t,a){const s=(0,d.J)(t,"Source"),i=e.__controllers;a.radiusname&&((0,u.Zn)(i,"radius"),s.scale.setScalar(a.radius/s.geometry.parameters.radius));(function(e,t,a){const s=(0,d.J)(e,"Source"),i=(0,d.J)(e,"SpotLight");a.posXname&&((0,u.Zn)(t,"posX"),s.position.x=a.posX,i.position.x=a.posX,b(e)),a.posYname&&((0,u.Zn)(t,"posY"),s.position.y=a.posY,i.position.y=a.posY,b(e)),a.posZname&&((0,u.Zn)(t,"posZ"),s.position.z=a.posZ,i.position.z=a.posZ,b(e))})(t,i,a),(0,_.V)(s,i,a),function(e,t,a){const s=(0,d.J)(e,"SpotLight");a.lightcolorname&&((0,u.Zn)(t,"lightcolor"),s.color.set(a.lightcolor)),a.lightanglename&&((0,u.Zn)(t,"lightangle"),s.angle=m.M8C.degToRad(a.lightangle),b(e))}(t,i,a),(0,y.y)(t,i,a),(0,f.$)(s,i,a)}(n,a,r),e.update()})))}var w=a(7108);const R={name:"Cone beam light",setMaterial:"solid",setVisible:"1",setColor:"red",description:"Cone beam light",setLabel:!0,setGui:!0};class L extends m.ZAu{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.target=t,this.params={...R,...a},this.name=this.params.name,(0,w.T)("inforComponents",this.params.description),this.meshes=g(this),this.add(this.meshes.source,this.meshes.spotlight,this.meshes.spotlightHelper),this.params.setLabel&&function(e){const t=(0,d.J)(e,"Source"),a=(0,p._)(t.name,t.geometry.parameters.radius,t.geometry.parameters.radius);t.add(a)}(this),this.params.setGui&&function(e,t){const a=t.gui,s=(0,d.J)(e,"Source"),i=(0,d.J)(e,"SpotLight");x(t,a,e,{name:"Cone beam light",spherename:s.name?s.name:"Sphere",radius:s.geometry.parameters.radius,radiusname:"Radius (m)",posX:s.position.x,posXname:"Source X (m)",posY:s.position.y,posYname:"Source Y (m)",posZ:s.position.z,posZname:"Source Z (m)",color:s.material.color.getHex(),colorname:"Source color",lightname:"Cone beam light",lightcolor:i.color.getHex(),lightcolorname:"Light color",lightangle:m.M8C.radToDeg(i.angle),lightanglename:"Light angle",visible:e.visible,visiblename:"Visible",label:"Source",labelname:"Label",labelColor:16777215,labelColorname:"Label color",resetname:"Reset"})}(this,e)}}var C=a(372);var z=a(8043);const v={name:"Box",insert:"box",setMaterial:"Water",setXLength:"0.4 m",setYLength:"0.4 m",setZLength:"0.4 m",setVisible:"1",setColor:"blue",setLabel:!0,setGui:!0};class M extends m.Kj0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.params={...v,...t},this.name=this.params.name;let a=(0,z.f)(this.params.setMaterial);this.label=this.params.label?this.params.label:this.params.name,this.params.description=`${a} box (${this.params.setXLength} x ${this.params.setYLength} x ${this.params.setZLength})`,(0,w.T)("inforComponents",this.params.description),function(e){const t=e.params;e.material=new m.Wid({color:t.setColor?t.setColor:"aqua",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),e.geometry=new m.DvJ(1,1,1),t.setXLength&&(e.scale.x=(0,s.v)(t.setXLength)),t.setYLength&&(e.scale.y=(0,s.v)(t.setYLength)),t.setZLength&&(e.scale.z=(0,s.v)(t.setZLength))}(this),this.params.setLabel&&function(e){const t=(0,p._)(e.label,e.geometry.parameters.width/2,e.geometry.parameters.height/2);t.name="label"+e.name,e.add(t)}(this),this.params.setGui&&function(e,t){const a=t.gui,i=e.params;let n=(0,s.v)(i.setXLength),r=(0,s.v)(i.setYLength),o=(0,s.v)(i.setZLength),m={x:0,y:0,z:0};i.setTranslation&&(m=(0,s.A)(i.setTranslation));const l={name:e.label,visible:e.visible,visiblename:"Visible",sizeX:n,sizeXname:"Size X (m)",sizeY:r,sizeYname:"Size Y (m)",sizeZ:o,sizeZname:"Size Z (m)",posX:m.x,posXname:"Position X (m)",posY:m.y,posYname:"Position Y (m)",posZ:m.z,posZname:"Position Z (m)",color:e.material.color.getHex(),colorname:"Color",opacity:e.material.opacity,opacityname:"Opacity",wireframe:e.material.wireframe,wireframename:"Wireframe",label:e.label,labelname:"Label",labelColor:16777215,labelColorname:"Label color",resetname:"Reset Box"};(0,C.O)(t,a,e,l)}(this,e)}}var T=a(9167),H=a(6564),Z=a(6482);var V=a(4111);var Y=a(3855);function X(e,t,a,s){const i=function(e,t,a){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=new m.Kj0(e,t);(0,H.pK)(i,{setRtop:a.setRmax2,setRbottom:a.setRmax1,setHeight:a.setHeight});const n=new m.Kj0(e,t);(0,H.pK)(n,{setRtop:a.setRmin2,setRbottom:a.setRmin1,setHeight:a.setHeight});const r=V.yU.fromMesh(i,0),o=V.yU.fromMesh(n,1);let l;const c=n.geometry.parameters;l=0==c.radiusTop&&0==c.radiusBottom?r:r.subtract(o);const h=V.yU.toMesh(l,new m.yGw);return h.material=i.material,s&&(h.rotation.x=Math.PI/2),h}(t,a,s,!1);s.setTranslation&&(0,Y.L)(i,s),e.add(i)}function A(e,t,a){let s=(0,H.Y)(t,a);t.setTranslation&&(0,Y.L)(s,t),e.add(s)}var S=a(2366);var W=a(6285);function k(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=function(e){const t=(0,S.g)(e),a=["x","y","z"];for(let e=0;e<t.length;e++)if("1"==t[e])return a[e]}(t.setRotationAxis);let i=function(e){const t=(0,S.g)(e);return(0,W.OQ)(t[0],"degree").to("radian")}(t.setRotationAngle);a&&(i=-i),e.rotation[s]=i}function O(e){const t=e.params;e.name=t.name;const a=function(e){const t=new m.Wid({color:"red",transparent:!0,opacity:.5,depthWrite:!0});return{air:new m.Wid({color:e.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!0}),target:new m.Wid({color:e.target.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),copper:new m.Wid({color:e.target_support_bottom.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),collimator:new m.Wid({color:e.primary_collimator.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),filter:new m.Wid({color:e.flattening_filter_cone1.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),mylar:new m.Wid({color:"white",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),carbon:new m.Wid({color:"black",transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),alum:new m.Wid({color:e.back_scatter_plate.setColor,transparent:!0,opacity:.5,depthWrite:!0,wireframe:!1}),solid:t}}(t),s={box:new m.DvJ(1,1,1),cylinder:new m.fHI(1,1,1,32)},i=(0,T.s)(s.box,a.air,t),n=function(e,t,a){const s=new m.Kj0(e.cylinder,t.air);s.name=a.target_support.name,(0,H.wU)(s,{setRmax:a.target_support.setRmax,setHeight:a.target_support.setHeight});const i=new m.Kj0(e.cylinder,t.target);i.name=a.target.name,(0,H.wU)(i,{setRmax:a.target.setRmax,setHeight:a.target.setHeight,setTranslation:a.target.setTranslation});const n=(0,Z.z_)(a.target_support_top,t.copper);n.name=a.target_support_top.name,(0,Z.JA)(n,{setTranslation:a.target_support_top.setTranslation});const r=new m.Kj0(e.cylinder,t.copper);r.name=a.target_support_bottom.name,(0,H.wU)(r,{setRmax:a.target_support_bottom.setRmax,setHeight:a.target_support_bottom.setHeight,setTranslation:a.target_support_bottom.setTranslation});const o=new m.ZAu;return o.add(s,i,n,r),o}(s,a,t);(0,Y.x)(n,t.target_support);const r=function(e,t,a){const s=new m.Kj0(e.cylinder,t.collimator);(0,H.wU)(s,{setRmax:a.primary_collimator.setRmax1,setHeight:a.primary_collimator.setHeight});const i=new m.Kj0(e.cylinder,t.air);(0,H.pK)(i,{setRtop:a.primary_collimator.setRmin2,setRbottom:a.primary_collimator.setRmin1,setHeight:a.primary_collimator.setHeight});const n=V.yU.fromMesh(s,0),r=V.yU.fromMesh(i,1),o=n.subtract(r),l=V.yU.toMesh(o,new m.yGw);return l.material=s.material,l.rotation.x=Math.PI/2,l.name=a.primary_collimator.name,l}(s,a,t);(0,Y.x)(r,t.primary_collimator);const o=function(e,t,a){const s=new m.ZAu;for(let i=1;i<=6;i++)X(s,e.cylinder,t.filter,a[`flattening_filter_cone${i}`]);return s.rotation.x=Math.PI/2,s.name=a.flattening_filter.name,s}(s,a,t);(0,Y.x)(o,t.flattening_filter);const l=function(e,t){const a=new m.ZAu;for(let s=1;s<=6;s++)A(a,t[`ionizing_chamber_mylar_1ayer${s}`],e.mylar),A(a,t[`ionizing_chamber_carbon_1ayer${s}`],e.carbon);return a.rotation.x=Math.PI/2,a.name=t.ionizing_chamber.name,a}(a,t);(0,Y.x)(l,t.ionizing_chamber);const c=(0,T.s)(s.box,a.alum,t.back_scatter_plate);c.name=t.back_scatter_plate.name,(0,Y.x)(c,t.back_scatter_plate);const h=function(e,t,a){const s=new m.ZAu,i=(0,T.s)(e,t.mylar,a.mirror_mylar);i.material.color=new m.Ilk(a.mirror_mylar.setColor),(0,Y.x)(i,{setTranslation:a.mirror_mylar.setTranslation});const n=(0,T.s)(e,t.alum,a.mirror_aluminium);return n.material.color=new m.Ilk(a.mirror_aluminium.setColor),(0,Y.x)(n,{setTranslation:a.mirror_aluminium.setTranslation}),s.add(i,n),s.name=a.mirror.name,s}(s.box,a,t);return(0,Y.x)(h,t.mirror),k(h,t.mirror,t.isG4),{head:i,target:n,collimator:r,filter:o,chamber:l,plate:c,mirror:h}}var J=a(4827);const P={name:"Linac head",insert:"box",setMaterial:"Air",setXLength:"0.5 m",setYLength:"0.5 m",setZLength:"0.8 m",setTranslation:"0 0 0 m",setVisible:"1",setColor:"yellow",setLabel:!0,setGui:!0,isG4:!0,target_support:{name:"target_support",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"15 mm",setHeight:"11 mm",setTranslation:"0 0 -5 mm",setVisible:"1"},target:{name:"target",insert:"cylinder",setMaterial:"target",setRmin:"0 mm",setRmax:"2.70 mm",setHeight:"1.00 mm",setTranslation:"0 0 5 mm",setColor:"red",setVisible:"1"},target_support_top:{name:"target_support_top",insert:"cylinder",setMaterial:"Copper",setRmin:"2.70 mm",setRmax:"15 mm",setHeight:"1.00 mm",setTranslation:"0 0 5 mm",setColor:"green",setVisible:"1"},target_support_bottom:{name:"target_support_bottom",insert:"cylinder",setMaterial:"Copper",setRmin:"0 mm",setRmax:"15 mm",setHeight:"10 mm",setTranslation:"0 0 -0.5 mm",setColor:"green",setVisible:"1"},primary_collimator:{name:"primary_collimator",insert:"cone",setMaterial:"collimator",setRmin2:"6.45 mm",setRmax2:"82 mm",setRmin1:"31.45 mm",setRmax1:"82 mm",setHeight:"101 mm",setTranslation:"0 0 -65.5 mm",setColor:"blue",setVisible:"1"},flattening_filter:{name:"flattening_filter",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"40 mm",setHeight:"24.1 mm",setTranslation:"0.0 0.0 -146.05 mm",setVisible:"0"},flattening_filter_cone1:{name:"flattening_filter_cone1",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"0.001 mm",setRmin1:"0 mm",setRmax1:"5.45 mm",setHeight:"3.40 mm",setTranslation:"0.0 0.0 +10.35 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone2:{name:"flattening_filter_cone2",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"5.45 mm",setRmin1:"0 mm",setRmax1:"9.00 mm",setHeight:"2.70 mm",setTranslation:"0.0 0.0 +7.3 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone3:{name:"flattening_filter_cone3",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"9.00 mm",setRmin1:"0 mm",setRmax1:"14.50 mm",setHeight:"4.90 mm",setTranslation:"0.0 0.0 +3.5 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone4:{name:"flattening_filter_cone4",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"14.50 mm",setRmin1:"0 mm",setRmax1:"22.50 mm",setHeight:"5.50 mm",setTranslation:"0.0 0.0 -1.7 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone5:{name:"flattening_filter_cone5",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"22.50 mm",setRmin1:"0 mm",setRmax1:"32.50 mm",setHeight:"5.60 mm",setTranslation:"0.0 0.0 -7.25 mm",setColor:"yellow",setVisible:"1"},flattening_filter_cone6:{name:"flattening_filter_cone6",insert:"cone",setMaterial:"filter",setRmin2:"0 mm",setRmax2:"38.50 mm",setRmin1:"0 mm",setRmax1:"38.50 mm",setHeight:"2.0 mm",setTranslation:"0.0 0.0 -11.05 mm",setColor:"yellow",setVisible:"1"},ionizing_chamber:{name:"ionizing_chamber",insert:"cylinder",setMaterial:"Air",setRmin:"0 mm",setRmax:"45 mm",setHeight:"9.28 mm",setTranslation:"0.0 0.0 -169 mm",setVisible:"0"},ionizing_chamber_mylar_1ayer1:{name:"ionizing_chamber_mylar_1ayer1",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 -2.634 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer1:{name:"ionizing_chamber_carbon_1ayer1",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 -2.627925 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer2:{name:"ionizing_chamber_mylar_1ayer2",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 -0.434 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer2:{name:"ionizing_chamber_carbon_1ayer2",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 -0.427925 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer3:{name:"ionizing_chamber_mylar_1ayer3",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 0.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer3:{name:"ionizing_chamber_carbon_1ayer3",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 0.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer4:{name:"ionizing_chamber_mylar_1ayer4",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 1.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer4:{name:"ionizing_chamber_carbon_1ayer4",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 1.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer5:{name:"ionizing_chamber_mylar_1ayer5",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 2.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer5:{name:"ionizing_chamber_carbon_1ayer5",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 2.572075 mm",setVisible:"1"},ionizing_chamber_mylar_1ayer6:{name:"ionizing_chamber_mylar_1ayer6",insert:"cylinder",setMaterial:"Mylar",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.012 mm",setTranslation:"0.0 0.0 3.566 mm",setVisible:"1"},ionizing_chamber_carbon_1ayer6:{name:"ionizing_chamber_carbon_1ayer6",insert:"cylinder",setMaterial:"Carbon",setRmin:"0 mm",setRmax:"45 mm",setHeight:"0.000150 mm",setTranslation:"0.0 0.0 3.572075 mm",setVisible:"1"},back_scatter_plate:{name:"back_scatter_plate",insert:"box",setMaterial:"Aluminium",setXLength:"116 mm",setYLength:"84 mm",setZLength:"3 mm",setTranslation:"0 0 -183 mm",setVisible:"1",setColor:"red"},mirror:{name:"mirror",insert:"box",setMaterial:"Air",setXLength:"137 mm",setYLength:"137 mm",setZLength:"1.5 mm",setTranslation:"0.0 0.0 -225 mm",setRotationAxis:"1 0 0",setRotationAngle:"37.5 deg",setVisible:"1"},mirror_mylar:{name:"mirror_mylar",insert:"box",setMaterial:"Mylar",setXLength:"110 mm",setYLength:"110 mm",setZLength:"0.0012 mm",setTranslation:"0 0 0.15 mm",setVisible:"1",setColor:"blue"},mirror_aluminium:{name:"mirror_aluminium",insert:"box",setMaterial:"Aluminium",setXLength:"110 mm",setYLength:"110 mm",setZLength:"0.0003 mm",setTranslation:"0 0 -0.6 mm",setVisible:"1",setColor:"white"}};class j extends m.ZAu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.params={...P,...t},this.labels=[],this.params.description="Linac head includes target, primary collimator, flattening filter, \n    ionizing chamber, back scatter plate, mirror",(0,w.T)("inforComponents",this.params.description),this.meshes=O(this),this.add(this.meshes.head,this.meshes.target,this.meshes.collimator,this.meshes.filter,this.meshes.chamber,this.meshes.plate,this.meshes.mirror),this.params.setLabel&&function(e){e.params;const t=e.meshes.head,a=(0,p._)(e.name,0,t.geometry.parameters.width/3,-t.geometry.parameters.height/3);a.name="label"+e.name,e.add(a),e.labels.push(a.name)}(this),this.params.setGui&&function(e,t){const a=t.gui,s={name:"Linac head",visible:e.visible,visiblename:"Visible",opacity:.5,opacityname:"Opacity",label:"Linac head",labelname:"Label",labelColor:16777215,labelColorname:"Label color",labelVisible:(0,d.J)(e,e.labels[0]).visible,labelVisiblename:"Label visible",resetname:"Reset Linac head"};(0,J.w)(t,a,e,s)}(this,e)}}var I=a(7263);var D=a(1480),K=a(1494);const G={description:"Simulation: Medical linear accelerator (LINAC)",infors:{authors:["Trang Hoang, Huynh Anh Dung"],data:"https://drive.google.com/file/d/1SM_gq5qj8Bje9DgJMZrDsm8MJFb_QDTs",refs:{"SARRUT David, Gate exercices, 3_linac":"https://gitlab.in2p3.fr/davidsarrut/gate-exercices/-/tree/master/3_linac?ref_type=heads"}},color:6316128,setLabel:!0,setGui:!0,showInfor:!0,world:{setMaterial:"Air",setXLength:"1. m",setYLength:"1. m",setZLength:"2.5. m"},waterbox:{setXLength:"300 mm",setYLength:"300 mm",setZLength:"300 mm",setTranslation:"0 0 -1000 mm",setColor:"blue"},source:{pos_sigma_x:"1.274 mm",pos_sigma_y:"1.274 mm",deg:.1,intensity:50}};class U extends m.ZAu{constructor(e,t,a){super(),this.params={...G,...a},this.description="Simulation: Medical linear accelerator (LINAC)",this.size=e,this.gui=t,this.axis=!0,this.meshes=function(e){const t=e.size,a=new M(e,e.params.waterbox),i=(0,s.A)(e.params.waterbox.setTranslation);return a.position.set(i.x,i.y,i.z),{phantom:a,linac:new j(e),conebeamLight:new L(e,a,e.params.source),axes:(0,l.q)(t/2,"m",t/2e3,e.axis),beam:(0,c.I)()}}(this),this.add(this.meshes.axes,this.meshes.phantom,this.meshes.linac,this.meshes.conebeamLight,this.meshes.beam),this.runs=[],this.zoomscale=2,this.rotation.set(-Math.PI/2,0,Math.PI/2),this.position.set(0,.5*this.size,0),this.params.setGui&&function(e){const t=e.gui,a={name:"World",rotX:m.M8C.radToDeg(e.rotation.x),rotXname:"Rotation X",rotY:m.M8C.radToDeg(e.rotation.y),rotYname:"Rotation Y",rotZ:m.M8C.radToDeg(e.rotation.z),rotZname:"Rotation Z",bgColor:e.params.color,bgColorname:"Background",resetname:"Reset World"};(0,C.O)(e,t,e,a);const s=e.meshes.axes,i={name:"Axes",visible:s.visible,visiblename:"Visible"};(0,I.W)(e,t,s,i)}(this)}setBackgroundColor(){}update(){}zoom(e){}tick(e){}async init(){this.setBackgroundColor(this.params.color),this.zoom(this.zoomscale),(0,K.$)(this,this.params.showInfor),await(0,D.J)(this)}}var $=a(6688),B=a(2036),E=a(1431),q=a(8925),F=a(717);let N,Q,ee,te,ae,se,ie,ne,re=0;class oe{constructor(e){this.worldParams={setXLength:G.world.setXLength,setYLength:G.world.setYLength,setZLength:G.world.setZLength},Object.keys(this.worldParams).forEach((e=>{if(e.includes("Length")){let t=(0,s.v)(this.worldParams[e]);re<t&&(re=t)}})),N=(0,i.d)(0,0,re),te=(0,r.a)(),Q=(0,B.U)(),ee=(0,E.c)(),ie=(0,o.k)(),ae=new F.r(N,te,Q,ee),e.append(Q.domElement,ee.domElement),se=(0,$.W)(N,ee.domElement),ne=new U(re,ie,this.worldParams),(0,n.Wc)(N,10,10,10,"white",3),ae.updatables.push(se),te.add(N,ne),ne.setBackgroundColor=e=>{te.background=new m.Ilk(e),this.render()},ne.zoom=e=>{N.position.z*=e,this.render()},ne.update=()=>{this.render()};new q.w(e,N,Q,ee).onResize=()=>{this.render()},se.addEventListener("change",(()=>{this.render()}))}render(){Q.render(te,N),ee.render(te,N)}start(){ae.start()}stop(){ae.stop()}async init(){await ne.init()}}a(8233),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",ready):async function(){const e=document.querySelector("#scene-container");e.style.display="block";const t=new oe(e);await t.init(),t.render()}().catch((e=>{console.log(e)}))},8233:(e,t,a)=>{a.r(t)}},e=>{e.O(0,[395,464],(()=>{return t=293,e(e.s=t);var t}));e.O()}]);